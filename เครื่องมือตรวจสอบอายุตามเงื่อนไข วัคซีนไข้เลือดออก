<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ตรวจสอบเงื่อนไขอายุ (7 ถึง ต่ำกว่า 11 ปี)</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for aesthetic */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- Main Card Container -->
    <div class="w-full max-w-lg bg-white shadow-2xl rounded-xl p-8 space-y-6">

        <!-- Header -->
        <header class="text-center">
            <h1 class="text-3xl font-extrabold text-blue-800">เครื่องมือตรวจสอบอายุตามเงื่อนไข</h1>
            <p class="mt-2 text-gray-600 text-lg">กลุ่มเป้าหมาย: เด็กไทย อายุ 7 ปีขึ้นไป ถึง ต่ำกว่า 11 ปี</p>
            <p class="mt-1 text-sm text-gray-500 font-medium">ช่วงวันเกิดที่กำหนด:</p>
            <p class="text-base font-semibold text-red-600">18 พ.ย. 2557 <span class="text-gray-400 mx-2">ถึง</span> 16 พ.ย. 2561</p>
        </header>

        <!-- Input Section -->
        <div class="space-y-4">
            <label class="block text-lg font-medium text-gray-700 mb-2">ระบุวันเดือนปีเกิด (พ.ศ.)</label>
            <div class="flex space-x-3">
                <!-- Day Input -->
                <input type="number" id="dayInput" placeholder="วัน" min="1" max="31" class="w-1/4 p-3 border-2 border-blue-300 rounded-lg focus:ring-4 focus:ring-blue-500 focus:border-blue-500 transition duration-150 text-center" required>
                <!-- Month Input -->
                <input type="number" id="monthInput" placeholder="เดือน" min="1" max="12" class="w-1/4 p-3 border-2 border-blue-300 rounded-lg focus:ring-4 focus:ring-blue-500 focus:border-blue-500 transition duration-150 text-center" required>
                <!-- Year Input (BE) -->
                <input type="number" id="yearInput" placeholder="พ.ศ." min="2500" max="2568" class="w-1/2 p-3 border-2 border-blue-300 rounded-lg focus:ring-4 focus:ring-blue-500 focus:border-blue-500 transition duration-150 text-center" required>
            </div>
            
            <button id="checkButton" onclick="checkEligibility()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-md transition duration-150 ease-in-out transform hover:scale-[1.01]">
                ตรวจสอบ
            </button>
        </div>

        <!-- Result Section -->
        <div id="resultContainer" class="mt-6 p-5 border-2 rounded-lg transition duration-300 hidden">
            <p id="resultText" class="text-center font-semibold text-xl"></p>
        </div>

        <!-- Note Section -->
        <footer class="text-center text-xs text-gray-400 pt-4 border-t">
            <p>*อายุคำนวณจากวันเกิดเทียบกับวันที่ปัจจุบัน</p>
            <p>*ระบบจะแปลง พ.ศ. เป็น ค.ศ. (พ.ศ. - 543) ในการคำนวณเปรียบเทียบตามมาตรฐานสากล</p>
        </footer>
    </div>

    <script>
        // กำหนดขอบเขตวันเกิดที่ถูกต้องเป็น ค.ศ. (พ.ศ. ลบด้วย 543)
        // 18 พฤศจิกายน 2557 (Nov 18, 2014)
        const START_DATE = new Date('2014-11-18T00:00:00');
        // 16 พฤศจิกายน 2561 (Nov 16, 2018)
        const END_DATE = new Date('2018-11-16T00:00:00');

        const resultContainer = document.getElementById('resultContainer');
        const resultText = document.getElementById('resultText');

        // ฟังก์ชันคำนวณอายุที่แม่นยำ (ปี เดือน วัน)
        function calculateAge(birthDate, referenceDate) {
            let ageYears = referenceDate.getFullYear() - birthDate.getFullYear();
            let ageMonths = referenceDate.getMonth() - birthDate.getMonth();
            let ageDays = referenceDate.getDate() - birthDate.getDate();

            // ปรับวันและเดือน
            if (ageDays < 0) {
                ageMonths--;
                // หาวันในเดือนที่แล้วของวันอ้างอิง
                const daysInLastMonth = new Date(referenceDate.getFullYear(), referenceDate.getMonth(), 0).getDate();
                ageDays += daysInLastMonth;
            }

            if (ageMonths < 0) {
                ageYears--;
                ageMonths += 12;
            }

            // ตรวจสอบกรณีที่คำนวณได้เป็นติดลบ (วันเกิดในอนาคต)
            if (ageYears < 0) {
                return "วันที่เกิดไม่ถูกต้อง (อยู่ในอนาคต)";
            }

            return `${ageYears} ปี ${ageMonths} เดือน ${ageDays} วัน`;
        }


        function checkEligibility() {
            // Get values from new input fields (assuming Buddhist Era - พ.ศ.)
            const dayBE = parseInt(document.getElementById('dayInput').value);
            const monthBE = parseInt(document.getElementById('monthInput').value);
            const yearBE = parseInt(document.getElementById('yearInput').value); // This is in B.E.
            
            // 1. ตรวจสอบว่ามีข้อมูลถูกใส่เข้ามาหรือไม่ และเป็นตัวเลขที่ถูกต้องในเบื้องต้น
            if (isNaN(dayBE) || isNaN(monthBE) || isNaN(yearBE) || dayBE < 1 || monthBE < 1 || monthBE > 12 || yearBE < 2500) {
                
                resultContainer.classList.remove('hidden');
                // Remove previous color classes
                resultContainer.classList.remove('border-green-400', 'border-red-400', 'bg-red-50', 'bg-green-50');
                resultText.classList.remove('text-green-700', 'text-red-700');

                // Set warning color
                resultContainer.classList.add('border-yellow-400', 'bg-yellow-50');
                resultText.classList.add('text-yellow-700');
                resultText.textContent = "กรุณากรอก วัน เดือน ปี (พ.ศ.) ให้ถูกต้องเป็นตัวเลข";
                return;
            }

            // 2. แปลง พ.ศ. เป็น ค.ศ. (ค.ศ. = พ.ศ. - 543)
            const yearCE = yearBE - 543;
            // JavaScript Date objects ใช้ month index เริ่มจาก 0 (0=ม.ค., 11=ธ.ค.)
            const monthIndexCE = monthBE - 1; 

            // 3. สร้าง Date object ด้วย ค.ศ. เพื่อเปรียบเทียบ
            // Note: new Date(year, monthIndex, day)
            const inputDate = new Date(yearCE, monthIndexCE, dayBE);
            const today = new Date();
            
            // ตรวจสอบความถูกต้องของวันที่ตามปฏิทิน
            if (inputDate.getFullYear() !== yearCE || inputDate.getMonth() !== monthIndexCE || inputDate.getDate() !== dayBE) {
                 resultContainer.classList.remove('hidden');
                 resultContainer.classList.remove('border-green-400', 'border-red-400', 'bg-red-50', 'bg-green-50');
                 resultText.classList.remove('text-green-700', 'text-red-700');

                 // Set warning color
                 resultContainer.classList.add('border-yellow-400', 'bg-yellow-50');
                 resultText.classList.add('text-yellow-700');
                 resultText.textContent = `วันที่ไม่ถูกต้องตามปฏิทิน: ${dayBE}/${monthBE}/${yearBE} ไม่สามารถเป็นวันจริงได้`;
                 return;
            }

            // 4. คำนวณอายุ
            const ageString = calculateAge(inputDate, today);

            // 5. ทำการตรวจสอบเงื่อนไขกลุ่มเป้าหมาย (Fixed Range)
            // เงื่อนไข: วันเกิดต้อง 'มากกว่าหรือเท่ากับ' วันที่เริ่มต้น AND 'น้อยกว่าหรือเท่ากับ' วันที่สิ้นสุด
            const isEligible = inputDate >= START_DATE && inputDate <= END_DATE;

            // 6. แสดงผลลัพธ์
            resultContainer.classList.remove('hidden');
            resultText.classList.remove('text-green-700', 'text-red-700', 'text-yellow-700');
            resultContainer.classList.remove('border-green-400', 'border-red-400', 'bg-red-50', 'bg-green-50', 'border-yellow-400', 'bg-yellow-50');
            
            let eligibilityMessage = '';

            if (isEligible) {
                // กรณีผ่านเงื่อนไข
                resultContainer.classList.add('border-green-400', 'bg-green-50');
                resultText.classList.add('text-green-700');
                eligibilityMessage = `
                    <span class="text-3xl">✅</span>
                    <br>
                    วันเกิดอยู่ในช่วงที่กำหนด!
                    <div class="text-base mt-2 font-normal">มีสิทธิ์อยู่ในกลุ่มเป้าหมาย (7 ปี ถึง ต่ำกว่า 11 ปี)</div>
                `;
            } else {
                // กรณีไม่ผ่านเงื่อนไข
                resultContainer.classList.add('border-red-400', 'bg-red-50');
                resultText.classList.add('text-red-700');
                eligibilityMessage = `
                    <span class="text-3xl">❌</span>
                    <br>
                    วันเกิด<span class="font-bold">ไม่อยู่</span>ในช่วงที่กำหนด.
                    <div class="text-base mt-2 font-normal">วันเกิดที่กำหนดคือ 18/11/2557 ถึง 16/11/2561 เท่านั้น</div>
                `;
            }

            // เพิ่มอายุปัจจุบันในผลลัพธ์
            resultText.innerHTML = eligibilityMessage + `
                <div class="mt-3 pt-3 border-t border-gray-300">
                    <span class="text-base font-semibold text-gray-800">อายุปัจจุบัน:</span>
                    <span class="text-xl font-bold text-blue-600">${ageString}</span>
                </div>
            `;
        }
    </script>
</body>
</html>
